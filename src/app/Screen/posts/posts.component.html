<ion-content class="custom-scroll component-container">
  <ion-grid class="ion-no-padding post-container movil">
    <div class="scroll-container">

      <ion-row *ngFor="let post of posts" class="post">

        <ion-col class="user-info" size="12" style="display: flex; justify-content: space-between; align-items: center;">
          <!-- Contenedor izquierdo: Avatar y Nombre de usuario -->
          <div style="display: flex; align-items: center;">
            <ion-avatar>
              <img [src]="post.avatar" alt="Imagen de perfil"/>
            </ion-avatar>
            <span class="username">{{ post.nickname }}</span>
          </div>
          <!-- Icono alineado a la derecha con evento de click -->
          <ion-icon name="ellipsis-horizontal" class="more-button" (click)="presentPopover($event, post)"></ion-icon>
            <ion-popover #popover [isOpen]="isOpen" (didDismiss)="isOpen = false">
              <ng-template>
                <div *ngIf="!isAdmin1" style="margin: auto; padding-top: 10px;">
                   <ion-input placeholder="Razón de reporte" [(ngModel)]="reportReason"></ion-input>
                   <ion-col class="post-actions" size="12" style="display: flex; justify-content: center;">
                      <ion-button color="danger" (click)="reportPost(post)">
                        <ion-icon name="trash" slot="start"></ion-icon>
                        <ion-label>Reportar</ion-label>
                      </ion-button>
                  </ion-col>
                </div>
                <div *ngIf="isAdmin1" style="margin: auto">
                  <ion-col class="post-actions" size="12" style="display: flex; justify-content: center;">
                    <ion-button color="danger" (click)="deletePost(post, 'SANCTIONED')">
                      <ion-icon name="trash" slot="start"></ion-icon>
                      <ion-label>Eliminar y advertir</ion-label>
                    </ion-button>
                  </ion-col>
                  <ion-col class="post-actions" size="12" style="display: flex; justify-content: center;">
                    <ion-button color="success" (click)="deletePost(post, 'SOLVED')">
                      <ion-icon name="exit-outline" slot="start"></ion-icon>
                      <ion-label>Dejar pasar</ion-label>
                    </ion-button>
                  </ion-col>
                </div>
              </ng-template>
            </ion-popover>
        </ion-col>

        <!-- Imagen Principal -->
        <ion-col class="post-image" size="12">
          <ion-img [src]="post.image_post" class="responsive-image"></ion-img>
        </ion-col>

        <!-- Descripción -->
        <ion-col class="post-description" size="12">
          {{ post.post?.content }}
        </ion-col>

        <!-- Acciones del PostDetails -->
        <ion-col class="post-actions" size="12">
          <ion-button (click)="likePost(post)" class="action-button like-button" fill="clear">
            <ion-icon [name]="post.liked ? 'heart' : 'heart-outline'"></ion-icon>
            <span>{{ post.numlikes }}</span>
          </ion-button>
          <ion-button (click)="openNewCommentModal(post.post?.id)" class="action-button" fill="clear">
            <ion-icon name="chatbubble"></ion-icon>
            <span>{{ post.numcomments }}</span>
          </ion-button>
          <ion-button (click)="savePost(post)" class="action-button save-button" fill="clear">
            <ion-icon [name]="post.saved ? 'bookmark' : 'bookmark-outline'"></ion-icon>
          </ion-button>
          <ion-button (click)="sharePost(post)" class="action-button" fill="clear">
            <ion-icon name="share-social"></ion-icon>
          </ion-button>

        </ion-col>

        <!-- Comentario Destacado -->
        <ion-col (click)="viewPostDetails(post)" class="highlighted-comment" size="12">
          <div class="comment-container">
            <ion-avatar>
              <img [src]="post.avatarcomment" alt="Avatar del comentario" fill/>
            </ion-avatar>
            <span class="comment">
              <b>{{ post.nicknamecomment }}</b> {{ post.firstcomment }}
            </span>
          </div>
        </ion-col>
      </ion-row>
    </div>
  </ion-grid>
  <ion-fab horizontal="end" slot="fixed" vertical="bottom">

  </ion-fab>
</ion-content>
<app-shepherd></app-shepherd>

